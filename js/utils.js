Global.initUtils=()=>{Global.utils={html_root_dom:document.querySelector("html"),pageContainer_dom:document.querySelector(".page-container"),pageTop_dom:document.querySelector(".main-content-header"),homeBanner_dom:document.querySelector(".home-banner-container"),scrollProgressBar_dom:document.querySelector(".scroll-progress-bar"),pjaxProgressBar_dom:document.querySelector(".pjax-progress-bar"),pjaxProgressIcon_dom:document.querySelector(".pjax-progress-icon"),backToTopButton_dom:document.querySelector(".tool-scroll-to-top"),toolsList:document.querySelector(".hidden-tools-list"),toggleButton:document.querySelector(".toggle-tools-list"),innerHeight:window.innerHeight,pjaxProgressBarTimer:null,prevScrollValue:0,fontSizeLevel:0,isHasScrollProgressBar:Global.theme_config.global.scroll_progress.bar===true,isHasScrollPercent:Global.theme_config.global.scroll_progress.percentage===true,updateScrollStyle(){const e=window.pageYOffset||document.documentElement.scrollTop;const t=document.documentElement.scrollHeight;const o=window.innerHeight||document.documentElement.clientHeight;const s=Math.round(e/(t-o)*100);if(this.isHasScrollProgressBar){const r=(e/(t-o)*100).toFixed(3);this.scrollProgressBar_dom.style.visibility=s===0?"hidden":"visible";this.scrollProgressBar_dom.style.width=`${r}%`}if(this.isHasScrollPercent){const a=this.backToTopButton_dom.querySelector(".percent");this.backToTopButton_dom.classList.toggle("show",s!==0&&s!==undefined);a.innerHTML=s.toFixed(0)}if(Global.theme_config.navbar.auto_hide){this.pageTop_dom.classList.toggle("hide",this.prevScrollValue>o&&e>this.prevScrollValue)}else{this.pageTop_dom.classList.remove("hide")}this.prevScrollValue=e},registerWindowScroll(){window.addEventListener("scroll",()=>{this.updateScrollStyle();if(Global.theme_config.articles.toc.enable&&Global.utils.hasOwnProperty("updateActiveTOCLink")){Global.utils.updateActiveTOCLink()}navbarShrink.init();var e=window.pageYOffset;var t=document.body.scrollHeight;var o=window.innerHeight;var s=document.getElementsByClassName("right-side-tools-container");for(var r=0;r<s.length;r++){var a=s[r];if(e<=0){if(location.pathname!=="/"){}else{a.classList.add("hide")}}else if(e+o>=t-20){a.classList.add("hide")}else{a.classList.remove("hide")}}var l=document.getElementById("aplayer");if(l==null){}else{if(e<=0){if(location.pathname!=="/"){}else{l.classList.add("hide")}}else if(e+o>=t-20){l.classList.add("hide")}else{l.classList.remove("hide")}}})},toggleToolsList(){this.toggleButton.addEventListener("click",()=>{this.toolsList.classList.toggle("show")})},globalFontSizeAdjust(){const t=this.html_root_dom;const e=document.querySelector(".tool-font-adjust-plus");const o=document.querySelector(".tool-font-adjust-minus");const s=document.defaultView.getComputedStyle(document.body).fontSize;const r=parseFloat(s);let a=0;const l=Global.getStyleStatus();if(l){a=l.fontSizeLevel;i(a)}function i(e){t.style.fontSize=`${r*(1+e*.05)}px`;Global.styleStatus.fontSizeLevel=e;Global.setStyleStatus()}e.addEventListener("click",()=>{switch(a){case 0:a=1;break;case 1:a=2;break;case 2:a=3;break;case 3:a=4;break;case 4:a=5;break;default:break}i(a)});o.addEventListener("click",()=>{switch(a){case 1:a=0;break;case 2:a=1;break;case 3:a=2;break;case 4:a=3;break;case 5:a=4;break;default:break}i(a)})},contentAreaWidthAdjust(){const e=document.querySelector(".tool-expand-width");const t=document.querySelector(".navbar-content");const o=document.querySelector(".main-content");const s=e.querySelector("i");const r=Global.theme_config.global.content_max_width||"1000px";const a="90%";let l=r;let i=false;if(Global.theme_config.home_banner.enable===true&&window.location.pathname==="/"){l=parseInt(r)*1.2+"px"}const n=e=>{Global.styleStatus.isExpandPageWidth=e;Global.setStyleStatus();if(e){s.classList.remove("fa-expand");s.classList.add("fa-compress");t.style.maxWidth=a;o.style.maxWidth=a}else{s.classList.remove("fa-compress");s.classList.add("fa-expand");t.style.maxWidth=l;o.style.maxWidth=r}};const c=()=>{const e=Global.getStyleStatus();if(e){i=e.isExpandPageWidth;n(i)}};c();e.addEventListener("click",()=>{i=!i;n(i)})},goComment(){this.goComment_dom=document.querySelector(".go-comment");if(this.goComment_dom){this.goComment_dom.addEventListener("click",()=>{document.querySelector("#comment-anchor").scrollIntoView({behavior:"smooth"})})}},getElementHeight(e){const t=document.querySelector(e);return t?t.getBoundingClientRect().height:0},inithomeBannerHeight(){this.homeBanner_dom&&(this.homeBanner_dom.style.height=this.innerHeight+"px")},initPageHeightHandle(){if(this.homeBanner_dom)return;const e=this.getElementHeight(".main-content-header");const t=this.getElementHeight(".main-content-body");const o=this.getElementHeight(".main-content-footer");const s=e+t+o;const r=window.innerHeight;const a=document.querySelector(".main-content-footer");if(s<r){const l=Math.floor(r-s);if(l>0){a.style.marginTop=`${l-2}px`}}},imageViewer(){let t=false;const o=(e,t)=>{document.body.style.overflow=t?"hidden":"auto";if(t){e.classList.add("active")}else{e.classList.remove("active")}};const s=document.querySelector(".image-viewer-container");const r=document.querySelector(".image-viewer-container img");s&&s.addEventListener("click",()=>{t=false;o(s,t)});const e=document.querySelectorAll(".markdown-body img");if(e.length){e.forEach(e=>{e.addEventListener("click",()=>{t=true;o(s,t);r.setAttribute("src",e.getAttribute("src"))})})}else{this.pageContainer_dom.removeChild(s)}},setHowLongAgoLanguage(e,t){return t.replace(/%s/g,e)},getHowLongAgo(e){const t=Global.language_ago;const o=Math.floor(e/(60*60*24*30)/12);const s=Math.floor(e/(60*60*24*30));const r=Math.floor(e/(60*60*24)/7);const a=Math.floor(e/(60*60*24));const l=Math.floor(e/(60*60)%24);const i=Math.floor(e/60%60);const n=Math.floor(e%60);if(o>0){return this.setHowLongAgoLanguage(o,t.year)}else if(s>0){return this.setHowLongAgoLanguage(s,t.month)}else if(r>0){return this.setHowLongAgoLanguage(r,t.week)}else if(a>0){return this.setHowLongAgoLanguage(a,t.day)}else if(l>0){return this.setHowLongAgoLanguage(l,t.hour)}else if(i>0){return this.setHowLongAgoLanguage(i,t.minute)}else if(n>0){return this.setHowLongAgoLanguage(n,t.second)}},relativeTimeInHome(){const e=document.querySelectorAll(".home-article-meta-info .home-article-date");const t=Global.theme_config.home.article_date_format;if(t==="relative"){e&&e.forEach(e=>{const t=Date.now();const o=new Date(e.dataset.date.split(" GMT")[0]).getTime();e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3))})}else if(t==="auto"){e&&e.forEach(e=>{const t=Date.now();const o=new Date(e.dataset.date.split(" GMT")[0]).getTime();const s=Math.floor((t-o)/(60*60*24*1e3));if(s<7){e.innerHTML=this.getHowLongAgo(Math.floor((t-o)/1e3))}})}},pjaxProgressBarStart(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer);if(this.isHasScrollProgressBar){this.scrollProgressBar_dom.classList.add("hide")}this.pjaxProgressBar_dom.style.width="0";this.pjaxProgressIcon_dom.classList.add("show");let e=1;const t=99;this.pjaxProgressBar_dom.classList.add("show");this.pjaxProgressBar_dom.style.width=e+"%";this.pjaxProgressBarTimer=setInterval(()=>{e+=5;if(e>t)e=t;this.pjaxProgressBar_dom.style.width=e+"%"},100)},pjaxProgressBarEnd(){this.pjaxProgressBarTimer&&clearInterval(this.pjaxProgressBarTimer);this.pjaxProgressBar_dom.style.width="100%";const t=setTimeout(()=>{this.pjaxProgressBar_dom.classList.remove("show");this.pjaxProgressIcon_dom.classList.remove("show");if(this.isHasScrollProgressBar){this.scrollProgressBar_dom.classList.remove("hide")}const e=setTimeout(()=>{this.pjaxProgressBar_dom.style.width="0";clearTimeout(t),clearTimeout(e)},200)},200)}};Global.utils.registerWindowScroll();Global.utils.toggleToolsList();Global.utils.globalFontSizeAdjust();Global.utils.contentAreaWidthAdjust();Global.utils.goComment();Global.utils.initPageHeightHandle();Global.utils.inithomeBannerHeight();Global.utils.imageViewer();Global.utils.relativeTimeInHome()};