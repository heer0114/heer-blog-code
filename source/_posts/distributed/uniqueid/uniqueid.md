---
title: 分布式全局唯一ID
tags:
  - 全局唯一ID
categories:
  - 分布式
  - 全局唯一ID
abbrlink: 21c5149c
date: 2022-08-08 19:59:18
banner:
---

>本文主要介绍常见的分布式ID生成方式，大致分类的话可以分为两类：**一种是类DB型的**，根据设置不同起始值和步长来实现趋势递增，需要考虑服务的容错性和可用性; **另一种是类snowflake型**，这种就是将64位划分为不同的段，每段代表不同的涵义，基本就是时间戳、机器ID和序列数。这种方案就是需要考虑时钟回拨的问题以及做一些 buffer 的缓冲设计提高性能。

## 全局唯一ID

传统的单体架构的时候，我们基本是单库然后业务单表的结构。每个业务表的ID一般我们都是从1增，通过AUTO_INCREMENT=1设置自增起始值，但是在分布式服务架构模式下分库分表的设计，使得多个库或多个表存储相同的业务数据。这种情况根据数据库的自增ID就会产生相同ID的情况，不能保证主键的唯一性。

![img](https://pdai.tech/images/arch/arch-z-id-1.png)

如上图，如果第一个订单存储在 DB1 上则订单 ID 为1，当一个新订单又入库了存储在 DB2 上订单 ID 也为1。我们系统的架构虽然是分布式的，但是在用户层应是无感知的，重复的订单主键显而易见是不被允许的。那么针对分布式系统如何做到主键唯一性呢？

{% notel green 方案 %}

- UUID
- 数据库
- Redis
- 雪花算法
- 百度-uidgenerator
- 美团-Leaf

{%endnotel %}
